# Library Cloud Computing Project

This project demonstrates a microservices-based architecture for managing a library system. The system consists of three basic microservices:

- **User Service**: Handles user authentication and registration.
- **Book Service**: Manages the library's books, including availability.
- **Borrowing Service**: Allows users to borrow and return books.

---

### User Service
- **Port**: `3001`
- **Functionalities**:
  - `POST /api/users/signup`: Register a new user with the default role as `user`.
  - `POST /api/users/login`: Authenticate a user and return a JWT token for session management.

### Book Service
- **Port**: `3002`
- **Functionalities**:
  - `POST /api/books/add`: Only admins can add a new book to the library. Requires:
    - JWT token validation through `authenticateToken`.
    - Admin role validation through `authorizeAdmin`.
  - `GET /api/books`: Retrieve all books in the library with pagination support:
    - Query Parameters:
      - `page` (default: `1`): The current page of books.
      - `limit` (default: `10`): The number of books per page.
    - Example: `/api/books?page=2&limit=5`.
  - `GET /api/books/:id`: Retrieve a book by its ID.
  - `PUT /api/books/:id/borrow`: Mark a book as borrowed. 
  - `PUT /api/books/:id/return`: Mark a book as returned. 

### Borrowing Service
- **Port**: `3003`
- **Functionalities**:
  - `POST /api/borrows/borrow`: Borrow a book. This requires:
    - Verifying the user through a valid JWT token.
    - Checking the book's availability from the Book Service.
    - Creating a borrow record and updating the book's status in the Book Service.
  - `POST /api/borrows/:id/return`: Return a borrowed book. This requires:
    - Verifying the user through a valid JWT token.
    - Confirming that the user is the one who borrowed the book.
    - Updating the book's status in the Book Service and closing the borrow record.
  - `GET /api/borrows`: Retrieve all borrow records for the authenticated user with pagination support:
    - Query Parameters:
      - `page` (default: `1`): The current page of borrow records.
      - `limit` (default: `10`): The number of borrow records per page.
    - Example: `/api/borrows?page=1&limit=5`.

---

## Microservices Communication

The microservices communicate with each other using HTTP REST APIs:

1. **Borrowing Service ↔ Book Service**:
   - The Borrowing Service interacts with the Book Service to:
     - Check the availability of a book before borrowing.
     - Update the book's status when borrowed or returned.

2. **Borrowing Service ↔ User Service**:
   - The Borrowing Service validates the user’s JWT token (generated by the User Service) to ensure only authenticated users can borrow or return books.